---
title: "Mandatory Assignment 1"
author: "HÃ¥kon Berggren Olsen"
date: "Spring 2020"
output:
  pdf_document: default
  html_document: default
subtitle: STK2100
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

# Problem 1.
The dataset, nuclear, contains data regarding the construction of 32 Light-Water Reactors built between 1967 and 1971. The scope of the dataset is to predict the cost of construction for further span given the dataset within this time interval. 

The dataset has 32 rows and 11 columns, and has a mix of continous- and categorical variabels. Contionous data such as regarding the cost, construction and net capacity of the a given nuclear powerplant, and categorical such as cooling tower present or absent, if there exists an LWR (Light-Water Reactor) plant at the same site and such. 

The description of all the variables are shown in a table below. 

| **Name**        	|                                                     **Continous Variables**                                                     	|
|------------------	|:-------------------------------------------------------------------------------------------------------------------------------:	|
| cost:            	| The capital cost of construction in millions of dollars adjusted to 1976 base.                                                  	|
| date:            	| The date on which the construction permit was issued. The data are measured in years since January 1 1990 to the nearest month. 	|
| t1:              	| The time between application for and issue of the construction permit.                                                          	|
| t2:              	| The time between issue of operating license and construction permit.                                                            	|
| cap:             	| The net capacity of the power plant (MWe).                                                                                      	|
| cum.n:           	| The cumulative number of power plants constructed by each architect-engineer.                                                   	|
| **Name** 	        |                                                    **Categorical Variables**                                                      |
|------------------	|---------------------------------------------------------------------------------------------------------------------------------	|
| pr:              	| A binary variable where 1 indicates the prior existence of a LWR plant at the same site.                                        	|
| ne:              	| A binary variable where 1 indicates that the plant was constructed in the north-east region of the U.S.A.                       	|
| ct:              	| A binary variable where 1 indicates the use of a cooling tower in the plant.                                                    	|
| bw:              	| A binary variable where 1 indicates that the nuclear steam supply system was manufactured by Babcock-Wilcox.                    	|
| pt:              	| A binary variable where 1 indicates those plants with partial turnkey guarantees.                                               	|

## a)

Loading the dataset

```{r cars}
datadir = "http://www.uio.no/studier/emner/matnat/math/STK2100/data/"
nuclear = read.table(paste(datadir, "nuclear.dat", sep=""), header=T)
```

Generating some plots to gain an intuition for the dataset.

```{r}
plot(nuclear)
```
This is very cluttered and hard to grasp, much due to categorical variables not giving any immeadiate insight. Therefore we will plot the dataset only regarding the continous variables.

```{r}
cont_var <- c("cost", "date", "t1", "t2", "cap", "cum.n")
cat_var <- c("pr", "ne", "ct", "bw", "pt")
plot(nuclear[cont_var])
```
\

From this figure we can see some clear trends. We can see the cost of the LWRs are increasing over time, which can be attributed to inflation. A very positive correlation is also spotted in the t1 vs date indicating that the time between application and issue of the construction permits is steadily increasing and almost doubles at the end of the dataset. t2 vs date shows however a negative correlation, indicating that it takes shorter and shorter time from obtaining operating license to gaining construction permit.

The net capacity of the LWR, cap, does show a slight increase with cost. This is expected as the capital cost of the investment should match it's returns.

NOTE: still not sure how the cum.n "The cumulative number of power plants constructed by each architect-engineer."  --- what architect-engineer? -- is construed.


## b) Constructing a model

Look at the model 

$$ Y_i = \beta_0 +\beta_1 x_{i,1}+ \cdot\cdot\cdot +\beta_p x_{p,i} + \epsilon_i $$

where $Y_i$ is cost at log scale for observation $i$. 

 - What are the standard assumptions about the noise term $\epsilon_i$? Discuss also which of these assumptions that are the most important?
    The assumptions of the noise term $\epsilon_i$ is that it is normally distributed. 




 - Fit this model including all the observations with log(cost) as response and all the other variables as covariates. Discuss the results
 
```{r}
#fit with all covariates
model2 = lm(log(cost)~., data=nuclear)
summary(model)
```
Discuss the results here

## c) 
Removing the highest corresponding P-value, i.e. t1 gives a better result as a high P-value means that the outcomes in $log(cost)$ cannot be sufficiently explained by the changes in $t1$. When doing this we get

```{r}
#Fit with t1 taken away.
model2 = lm(log(cost)~.-t1,data=nuclear)
summary(model2)

```
 
 An increase from 13.28 to 15.42 in the F-statistic (explain F-statistic), increase of the multiple R-squared from 0.8635 to 0.8631 and likewise 0.7985 to 0.8072 for the adjusted R-squared. 
 
## d) 

Continuing to remove all explanatory variables untill all P-values are less than $0.05$. What is the final model?
Make different plots in order to evaluate whether the model is reasonable.



Use the final model to predict response and make a model based on the average quadratic error $(\frac{1}{n} \sum_{i=1}^n(y_i-\hat{y_i})^2)$ in order ot evaluate how good the model is. Discuss weaknesses with such a procedure. 


```{r}
d.new = data.frame(data=70.0, t1=13, t2=50, cap=800, pr=1, ne=0, ct=0, bw=1, cum.n=8, pt=1)



 