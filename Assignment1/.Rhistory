install.packages("MASS")
knitr::opts_chunk$set(echo = TRUE)
plot(nuclear)
knitr::opts_chunk$set(echo = TRUE)
datadir = "http://www.uio.no/studier/emner/matnat/math/STK2100/data/"
nuclear = read.table(paste(datadir, "nuclear.dat", sep=""), header=T)
plot(nuclear)
nuclear
cont_var <- c("cost", "date", "t1", "t2", "cap", "cum.n")
cat_var <- c("pr", "ne", "ct", "bw", "pt")
nuclear
cont_var <- c("cost", "date", "t1", "t2", "cap", "cum.n")
cat_var <- c("pr", "ne", "ct", "bw", "pt")
nuclear[cont_var]
cont_var <- c("cost", "date", "t1", "t2", "cap", "cum.n")
cat_var <- c("pr", "ne", "ct", "bw", "pt")
nuclear[cat_var]
cont_var <- c("cost", "date", "t1", "t2", "cap", "cum.n")
cat_var <- c("pr", "ne", "ct", "bw", "pt")
plot(nuclear[cont_var])
nuclear["cum.n"]
nuclear["date"]
nuclear["date"].min
min(nuclear["date"])
max(nuclear["date"])
fit <- lm.fit(nuclear ~ log(cost))
model <- lm.fit(nuclear ~ log(cost))
model <- lm.fit(nuclear ~ log(nuclear$cost))
knitr::opts_chunk$set(echo = TRUE)
features <- c("date", "t1", "t2", "cap", "cum.n","pr", "ne", "ct", "bw", "pt")
model <- lm.fit(nuclear ~ log(nuclear$cost))
features <- c("date", "t1", "t2", "cap", "cum.n","pr", "ne", "ct", "bw", "pt")
model <- lm.fit(nuclear$features ~ log(nuclear$cost))
nuclear$features
nuclear$date
nuclear[features]
features <- c("date", "t1", "t2", "cap", "cum.n","pr", "ne", "ct", "bw", "pt")
model <- lm.fit(nuclear[features] ~ log(nuclear$cost))
log(nuclear$cost)
type(log(nuclear$cost))
astype(log(nuclear$cost))
#fit with all covariates
model = lm(log(cost)~., data=nuclear)
#fit with all covariates
model = lm(log(cost)~., data=nuclear)
summary(model)
cont_var <- c("cost", "date", "t1", "t2", "cap", "cum.n")
cat_var <- c("pr", "ne", "ct", "bw", "pt")
plot(nuclear[cont_var])
#Fit with t1 taken away.
model2 = lm(log(cost)~.-t1,data=nuclear)
summary(model2)
knitr::opts_chunk$set(echo = TRUE)
model3 <- lm(log(cost)~, -t1-bw, data=nuclear)
model3 <- lm(log(cost)~, -t1-bw, data=nuclear))
model3 <- lm(log(cost)~. -t1-bw, data=nuclear))
model3 <- lm(log(cost)~. -t1-bw, data=nuclear)
summary(model3)
model3 <- lm(log(cost)~. -t1-bw, data=nuclear)
summary(model3)
model4 <- lm(log(cost)~. -t1-bw-t2, data=nuclear)
summary(model3)
model3 <- lm(log(cost)~. -t1-bw, data=nuclear)
summary(model3)
model4 <- lm(log(cost)~. -t1-bw-t2, data=nuclear)
summary(model4)
model3 <- lm(log(cost)~. -t1-bw, data=nuclear)
summary(model3)
model4 <- lm(log(cost)~. -t1-bw-t2, data=nuclear)
summary(model4)
model5 <- lm(log(cost)~. -t1-bw-t2-pr, data=nuclear)
summary(model5)
model3 <- lm(log(cost)~. -t1-bw, data=nuclear)
summary(model3)
model4 <- lm(log(cost)~. -t1-bw-pr, data=nuclear)
summary(model4)
model5 <- lm(log(cost)~. -t1-bw-t2-pr, data=nuclear)
summary(model5)
model3 <- lm(log(cost)~. -t1-bw, data=nuclear)
summary(model3)
model4 <- lm(log(cost)~. -t1-bw-pr, data=nuclear)
summary(model4)
model5 <- lm(log(cost)~. -t1-bw-pr-t2, data=nuclear)
summary(model5)
model3 <- lm(log(cost)~. -t1-bw, data=nuclear)
summary(model3)
model4 <- lm(log(cost)~. -t1-bw-pr, data=nuclear)
summary(model4)
model5 <- lm(log(cost)~. -t1-bw-pr-t2, data=nuclear)
summary(model5)
model5 <- lm(log(cost)~. -t1-bw-pr-t2-cum.n, data=nuclear)
summary(model5)
model3 <- lm(log(cost)~. -t1-bw, data=nuclear)
summary(model3)
model4 <- lm(log(cost)~. -t1-bw-pr, data=nuclear)
summary(model4)
model3 <- lm(log(cost)~. -t1, data=nuclear)
summary(model3)
model4 <- lm(log(cost)~. -t1-bw-pr, data=nuclear)
summary(model4)
model3 <- lm(log(cost)~. -t1-t2-pr-ct-bw-cum.n-pt, data=nuclear)
summary(model3)
model4 <- lm(log(cost)~. -t1-bw-pr, data=nuclear)
summary(model4)
model3 <- lm(log(cost)~. -t1-t2-pr-ct-bw-cum.n, data=nuclear)
summary(model3)
model4 <- lm(log(cost)~. -t1-bw-pr, data=nuclear)
summary(model4)
model3 <- lm(log(cost)~. -t1, data=nuclear)
summary(model3)
model4 <- lm(log(cost)~. -t1-bw-pr, data=nuclear)
summary(model4)
model3 <- lm(log(cost)~. -t1-bw, data=nuclear)
summary(model3)
model4 <- lm(log(cost)~. -t1-bw-pr, data=nuclear)
summary(model4)
model5 <- lm(log(cost)~. -t1-bw-pr-t2, data=nuclear)
summary(model5)
model5 <- lm(log(cost)~. -t1-bw-pr-t2-cum.n, data=nuclear)
summary(model5)
model6 <- lm(log(cost)~. -t1-bw-pr-t2-cum.n, data=nuclear)
summary(model6)
model3 <- lm(log(cost)~. -t1-bw, data=nuclear)
#summary(model3)
model4 <- lm(log(cost)~. -t1-bw-pr, data=nuclear)
summary(model4)
model5 <- lm(log(cost)~. -t1-bw-pr-t2, data=nuclear)
summary(model5)
model5 <- lm(log(cost)~. -t1-bw-pr-t2-cum.n, data=nuclear)
summary(model5)
model6 <- lm(log(cost)~. -t1-bw-pr-t2-cum.n, data=nuclear)
summary(model6)
model3 <- lm(log(cost)~. -t1-bw, data=nuclear)
#summary(model3)
model4 <- lm(log(cost)~. -t1-bw-pr, data=nuclear)
#summary(model4)
model5 <- lm(log(cost)~. -t1-bw-pr-t2, data=nuclear)
summary(model5)
model5 <- lm(log(cost)~. -t1-bw-pr-t2-cum.n, data=nuclear)
summary(model5)
model6 <- lm(log(cost)~. -t1-bw-pr-t2-cum.n, data=nuclear)
summary(model6)
model3 <- lm(log(cost)~. -t1-bw, data=nuclear)
#summary(model3)
model4 <- lm(log(cost)~. -t1-bw-pr, data=nuclear)
#summary(model4)
model5 <- lm(log(cost)~. -t1-bw-pr-t2, data=nuclear)
#summary(model5)
model5 <- lm(log(cost)~. -t1-bw-pr-t2-cum.n, data=nuclear)
summary(model5)
model6 <- lm(log(cost)~. -t1-bw-pr-t2-cum.n, data=nuclear)
summary(model6)
model3 <- lm(log(cost)~. -t1-bw, data=nuclear)
#summary(model3)
model4 <- lm(log(cost)~. -t1-bw-pr, data=nuclear)
#summary(model4)
model5 <- lm(log(cost)~. -t1-bw-pr-t2, data=nuclear)
#summary(model5)
model5 <- lm(log(cost)~. -t1-bw-pr-t2-cum.n, data=nuclear)
#summary(model5)
model6 <- lm(log(cost)~. -t1-bw-pr-t2-cum.n-ct, data=nuclear)
summary(model6)
model3 <- lm(log(cost)~. -t1-bw, data=nuclear)
#summary(model3)
model4 <- lm(log(cost)~. -t1-bw-pr, data=nuclear)
#summary(model4)
model5 <- lm(log(cost)~. -t1-bw-pr-t2, data=nuclear)
#summary(model5)
model5 <- lm(log(cost)~. -t1-bw-pr-t2-cum.n, data=nuclear)
#summary(model5)
model6 <- lm(log(cost)~. -t1-bw-pr-t2-cum.n-ct, data=nuclear)
summary(model6)
# Making plots of the final model from forward selection with the criteria of p values < 0.05
plot(cost ~ cap, data = nuclear)
# Making plots of the final model from forward selection with the criteria of p values < 0.05
plot(cost ~ cap, data = nuclear)
abline(model6)
# Making plots of the final model from forward selection with the criteria of p values < 0.05
library(ggplot2)
ggplot(nuclear, aes(x = cap, y = cost)) +
geom_point() +
stat_smooth(methdo="lm", col="red")
# Making plots of the final model from forward selection with the criteria of p values < 0.05
library(ggplot2)
ggplot(nuclear, aes(x = cap, y = cost)) +
geom_point() +
stat_smooth(method="lm", col="red")
# Making plots of the final model from forward selection with the criteria of p values < 0.05
library(ggplot2)
predicted_cost <- data.frame(cost_pred = predict(model7, nuclear), cost=df$cost)
# Making plots of the final model from forward selection with the criteria of p values < 0.05
library(ggplot2)
predicted_cost <- data.frame(cost_pred = predict(model6, nuclear), cost=df$cost)
# Making plots of the final model from forward selection with the criteria of p values < 0.05
library(ggplot2)
predicted_cost <- data.frame(cost_pred = predict(model6, nuclear), cost=nuclear$cost)
ggplot(nuclear, aes(x = cap, y = cost)) +
geom_point() +
geom_line(color="red", data = predicted_cost, aes(x=cap, y=cost))
datadir = "http://www.uio.no/studier/emner/matnat/math/STK2100/data/"
Fe <- read.table(paste(datadir, "fe.dat", sep=" "), header=T, sep=" ")
datadir = "http://www.uio.no/studier/emner/matnat/math/STK2100/data/"
Fe <- read.table(paste(datadir, "fe.dat", sep=""), header=T, sep=" ")
options(contrasts=c("contr.treamtent", "contr.treatment"))
fit1 <- lm(Fe~form, data=Fe)
Fe
#fit1 <- lm(Fe~form, data=Fe)
#summary(fit1)
Fe$form<- as.factor(Fe$form)
Fe$form <- as.factor(Fe$form)
#fit1 <- lm(Fe~form, data=Fe)
#summary(fit1)
#Fe$form <- as.factor(Fe$form)
Fe
#fit1 <- lm(Fe~form, data=Fe)
#summary(fit1)
datadir = "http://www.uio.no/studier/emner/matnat/math/STK2100/data/"
Fe <- read.table(paste(datadir, "fe.dat", sep=""), header=T, sep=" ")
options(contrasts=c("contr.treamtent", "contr.treatment"))
#Fe$form <- as.factor(Fe$form)
Fe
#fit1 <- lm(Fe~form, data=Fe)
#summary(fit1)
#Fe$form <- as.factor(Fe$form)
Fe
fit1 <- lm(Fe~form, data=Fe)
datadir = "http://www.uio.no/studier/emner/matnat/math/STK2100/data/"
Fe <- read.table(paste(datadir, "fe.dat", sep=""), header=T, sep=",")
options(contrasts=c("contr.treamtent", "contr.treatment"))
#Fe$form <- as.factor(Fe$form)
Fe
fit1 <- lm(Fe~form, data=Fe)
#summary(fit1)
#Fe$form <- as.factor(Fe$form)
fit1 <- lm(Fe~form, data=Fe)
#summary(fit1)
#Fe$form <- as.factor(Fe$form)
fit1 <- lm(Fe~form, data=Fe)
summary(fit1)
Fe$form <- as.factor(Fe$form)
fit2 <- lm(Fe~form, data=Fe)
datadir = "http://www.uio.no/studier/emner/matnat/math/STK2100/data/"
Fe <- read.table(paste(datadir, "fe.dat", sep=""), header=T, sep=",")
options(contrasts=c("contr.treamtent", "contr.treatment"))
#Fe$form <- as.factor(Fe$form)
fit1 <- lm(Fe~form, data=Fe)
summary(fit1)
Fe$form <- as.factor(Fe$form)
fit2 <- lm(Fe~form, data=Fe)
datadir = "http://www.uio.no/studier/emner/matnat/math/STK2100/data/"
Fe <- read.table(paste(datadir, "fe.dat", sep=""), header=T, sep=",")
options(contrasts=c("contr.treamtent", "contr.treatment"))
fit1 <- lm(Fe~form, data=Fe)
summary(fit1)
datadir = "http://www.uio.no/studier/emner/matnat/math/STK2100/data/"
Fe <- read.table(paste(datadir, "fe.dat", sep=""), header=T, sep=",")
options(contrasts=c("contr.treamtent", "contr.treatment"))
Fe$form <- as.factor(Fe$form)
fit1 <- lm(Fe~form, data=Fe)
#Fe$form <- as.factor(Fe$form)
#fit2 <- lm(Fe~form, data=Fe)
#summary(fit2)
datadir = "http://www.uio.no/studier/emner/matnat/math/STK2100/data/"
Fe <- read.table(paste(datadir, "fe.dat", sep=""), header=T, sep=",")
options(contrasts=c("contr.treamtent", "contr.treatment"))
Fe$form <- as.factor(Fe$form)
#fit1 <- lm(Fe~form, data=Fe)
#summary(fit1)
datadir = "http://www.uio.no/studier/emner/matnat/math/STK2100/data/"
Fe <- read.table(paste(datadir, "fe.dat", sep=""), header=T, sep=",")
options(contrasts=c("contr.treamtent", "contr.treatment"))
Fe$form <- as.factor(Fe$form)
Fe
#fit1 <- lm(Fe~form, data=Fe)
#summary(fit1)
datadir = "http://www.uio.no/studier/emner/matnat/math/STK2100/data/"
Fe <- read.table(paste(datadir, "fe.dat", sep=""), header=T, sep=",")
options(contrasts=c("contr.treamtent", "contr.treatment"))
Fe$form <- as.factor(Fe$form)
fit1 <- lm(Fe ~ form, data=Fe)
